<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mining Your Search Results &#8211; Collin Jennings</title>
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdn.mathjax.org">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="robots" content="all">
    <meta name="author" content="Collin Jennings">
    
    <meta name="keywords" content="">
    <link rel="canonical" href="http://collinjennings.com/2016/04/25/mining-search/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Collin Jennings" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?201611021746" type="text/css">

    <!-- Fonts -->
    
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Mining Your Search Results">
    <meta property="og:description" content="">
    <meta property="og:url" content="http://collinjennings.com/2016/04/25/mining-search/">
    <meta property="og:site_name" content="Collin Jennings">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
    <meta name="twitter:title" content="Mining Your Search Results" />
    <meta name="twitter:description" content="" />
    <meta name="twitter:url" content="http://collinjennings.com/2016/04/25/mining-search/" />

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">

    
</head>

<body class="site">
  
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://collinjennings.com" class="site-title">Collin Jennings</a>
      <nav class="site-nav">
        
    

    

    

    

    

    

    
        <a href="/about/">About</a>
    

    

    

    

    

    

    

    

    

    

    


    

    

    

    

    

    

    

    
        <a href="/contact/">Contact</a>
    

    

    

    

    

    

    

    

    

    


      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Mining Your Search Results</h1>
  <span class="post-meta">Apr 25, 2016</span><br>
  
  <span class="post-meta small">
  
    5 minute read
  
  </span>
</div>

<article class="post-content">
  <p><img src="/assets/search_logo.jpg" alt="'logo'" /></p>

<p>This tutorial was the third part of the “Search and Surveillance” Workshop series that I created for Bard College. It describes a technique for producing an co-occurrence network between search terms and journals listed in the results for those terms when used to query JSTOR’s Data for Research service. The rationale for producing such a network comes from my interest in the relationship between search and new understandings of disciplinarity. Put simply, how has search re-made our understanding of disciplinary boundaries? I came to this line of inquiry from my work, as a grad assistant, with Lisa Gitelman on the relationship between JSTOR and search. Lisa has published “Searching and Thinking about Searching JSTOR” in the Search Forum from <em>Representations</em> 127.1.</p>

<p>In this tutorial, we will:</p>

<ul>
  <li>Import Search metadata from <em>JSTOR Data for Research</em></li>
  <li>Create a network of search terms and academic journals that appear in the searches.</li>
  <li>Visualize the network graph of the search results in order to view something like the shape of interdisciplinarity in Liu’s essay.</li>
</ul>

<h3 id="import-necessary-libraries-and-functions">Import necessary libraries and functions</h3>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">community</span>
<span class="c">##functions for reading file and filename </span>
<span class="k">def</span> <span class="nf">remove_ext</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="c"># insert your code here</span>
    <span class="nb">file</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">file</span> 
<span class="k">def</span> <span class="nf">remove_dir</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="c"># insert your code here</span>
    <span class="n">direct</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">direct</span> 
<span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="c"># insert your code here</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">remove_ext</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">remove_dir</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">file</span>
<span class="k">def</span> <span class="nf">read_corpus_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>    
    <span class="s">"""Returns the full raw text of the corpus document, in a single string"""</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">)</span> <span class="c">#open(filepath)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">text</span>
<span class="k">def</span> <span class="nf">find_corpus_files</span><span class="p">(</span><span class="n">corpusdirectory</span><span class="p">):</span>
    <span class="s">"""Returns a list of all filenames of corpus files"""</span>
    <span class="k">return</span> <span class="n">glob</span><span class="p">(</span><span class="n">corpusdirectory</span> <span class="o">+</span> <span class="s">"/*.csv"</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">texts_containing</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">doc_list</span><span class="p">):</span>
    <span class="s">'''Takes a word and a list of documents (stored as word lists). 
    Returns number of words in a list of documents.'''</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">doc_list</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> 
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span> 
<span class="k">def</span> <span class="nf">idf</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">doc_list</span><span class="p">):</span>
    <span class="s">'''Takes a word and a lists of documents, and returns the inverse of the number of 
    documents that the word appears in.'''</span> 
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc_list</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">texts_containing</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">doc_list</span><span class="p">)))</span>
<span class="c">## importing file chunk </span>
<span class="n">corpusdirectory</span> <span class="o">=</span> <span class="s">"liu_transcendental_data"</span>
</code></pre>
</div>

<h3 id="import-jstor-csvs">Import JSTOR CSVs</h3>
<p>We are retrieving the the search results 15 bigram searches using the top 6 key terms for Liu’s 2004 <em>Critical Inquiry</em> article, “Transcendental Data: Toward a Cultureal History and Aesthetics of the New Encoded Discourse,” (Autumn, 2004). JSTOR’s top 6 key terms are: <code class="highlighter-rouge">database</code>, <code class="highlighter-rouge">discourse</code>, <code class="highlighter-rouge">content</code>, <code class="highlighter-rouge">management</code>, <code class="highlighter-rouge">document</code>, and <code class="highlighter-rouge">network</code>.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journal_edgelist</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">journal_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">find_corpus_files</span><span class="p">(</span><span class="n">corpusdirectory</span><span class="p">):</span> 
    <span class="n">query</span> <span class="o">=</span> <span class="n">get_filename</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'_'</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">read_corpus_file</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s">"Journal,ARTICLE_COUNT"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">continue</span> 
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">x</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf8'</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf8'</span><span class="p">)</span>
            <span class="n">journal</span><span class="p">,</span><span class="n">number</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">","</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c">#[1]#, 1)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">query</span><span class="p">:</span> 
                <span class="n">journal_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">journal</span><span class="p">,</span> <span class="n">number</span><span class="p">))</span>
</code></pre>
</div>

<h4 id="check-that-we-have-the-journals-for-each-search-term">Check that we have the journals for each search term.</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journal_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>dict_keys(['management', 'database', 'discourse', 'network', 'content', 'document'])
</code></pre>
</div>

<h3 id="weight-the-search-results-using-the-term-frequency-inverse-document-frequency-measure">Weight the search results using the Term Frequency-Inverse Document Frequency Measure</h3>
<p>This measure is a popular and conventional measure from Information Retrieval (the field responsible for many search algorithms) used to score terms in a document based on their relative frequency in that document and their inverse frequency in the larger corpus. It thus give higher scores to terms (or here journals) that often appear in one document (or search) and not in others, so as to reduce the noise from terms/journals that are frequent across all documents/searches.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journals</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">journal_corpus</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="k">for</span> <span class="n">query</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">journal_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
    <span class="n">query_list</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="k">for</span> <span class="n">journal</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span> 
        <span class="n">query_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">journal</span><span class="p">)</span>
        <span class="n">journals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">journal</span><span class="p">)</span>
    <span class="n">journal_corpus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_list</span><span class="p">)</span>
<span class="n">journals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">journals</span><span class="p">))</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journal_idf</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">journal</span> <span class="ow">in</span> <span class="n">journals</span><span class="p">:</span> 
    <span class="n">journal_idf</span><span class="p">[</span><span class="n">journal</span><span class="p">]</span> <span class="o">=</span> <span class="n">idf</span><span class="p">(</span><span class="n">journal</span><span class="p">,</span> <span class="n">journal_corpus</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 
</code></pre>
</div>

<h4 id="check-the-inverse-document-frequency-of-one-journal">Check the Inverse Document Frequency of one Journal</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journal_idf</span><span class="p">[</span><span class="s">'The American Historical Review'</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>0.8458493201727416
</code></pre>
</div>

<h4 id="first-we-we-will-get-the-tf-idf-score-for-each-journal">First we we will get the TF-IDF score for each journal</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journal_network2</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">query_list</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="k">for</span> <span class="n">query</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">journal_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">total_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c">#for key, value in query.items():</span>
    <span class="n">query_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">journal</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">total_value</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">journal</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">tf_idf_score</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">/</span><span class="n">total_value</span><span class="p">)</span> <span class="o">*</span><span class="n">journal_idf</span><span class="p">[</span><span class="n">journal</span><span class="p">]</span>
        <span class="n">journal_network2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">query</span><span class="p">,</span> <span class="n">journal</span><span class="p">,</span> <span class="n">tf_idf_score</span><span class="p">))</span>
</code></pre>
</div>

<h4 id="now-we-will-get-the-average-score--re-produce-the-network-with-a-filter-to-take-only-journals-that-have-scores-25-times-greater-than-the-average-score">Now we will get the average score &amp; re-produce the network with a filter to take only journals that have scores 2.5 times greater than the average score</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">total_score</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">journal_network2</span><span class="p">:</span>
    <span class="n">total_score</span> <span class="o">+=</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">total_score</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">journal_network2</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">journal_network2</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">query_list</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="k">for</span> <span class="n">query</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">journal_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">total_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c">#for key, value in query.items():</span>
    <span class="n">query_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">journal</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">total_value</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">journal</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">tf_idf_score</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">/</span><span class="n">total_value</span><span class="p">)</span> <span class="o">*</span><span class="n">journal_idf</span><span class="p">[</span><span class="n">journal</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tf_idf_score</span> <span class="o">&gt;</span> <span class="n">avg</span><span class="o">*</span><span class="mf">2.5</span><span class="p">:</span> 
            <span class="n">journal_network2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">query</span><span class="p">,</span> <span class="n">journal</span><span class="p">,</span> <span class="n">tf_idf_score</span><span class="p">))</span>
</code></pre>
</div>

<h3 id="create-network-graph">Create network graph</h3>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">networkx</span> <span class="kn">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">journal_network2</span><span class="p">:</span>
    <span class="n">wt</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">20</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="n">wt</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="alter-size-of-network-nodes-according-to-number-of-edges">Alter size of network nodes according to number of edges</h3>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">degrees</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span> 
    <span class="n">node_degree</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span> 
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
            <span class="n">node_degree</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">node_degree</span> <span class="o">=</span> <span class="n">node_degree</span><span class="o">*</span><span class="mi">50</span>
    <span class="n">degrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_degree</span><span class="p">)</span>
    <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</code></pre>
</div>

<h4 id="modify-edge-colors-in-network">Modify edge colors in network</h4>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">query_edges</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span> 
    <span class="k">if</span> <span class="s">'content'</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'r'</span><span class="p">)</span>
        <span class="n">query_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'discourse'</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'b'</span><span class="p">)</span>
        <span class="n">query_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'database'</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'g'</span><span class="p">)</span>
        <span class="n">query_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'management'</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'m'</span><span class="p">)</span>
        <span class="n">query_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'document'</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'y'</span><span class="p">)</span>
        <span class="n">query_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'network'</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span> 
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'c'</span><span class="p">)</span>
        <span class="n">query_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
<span class="n">color_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'r'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'m'</span><span class="p">,</span> <span class="s">'y'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">]</span>
<span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'content'</span><span class="p">,</span> <span class="s">'discourse'</span><span class="p">,</span> <span class="s">'database'</span><span class="p">,</span> <span class="s">'management'</span><span class="p">,</span> <span class="s">'document'</span><span class="p">,</span> <span class="s">'network'</span><span class="p">]</span>   
</code></pre>
</div>

<h2 id="plot--save-the-graph-as-png-file">Plot &amp; Save the graph as png file</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pos</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">query_list</span><span class="p">])</span> <span class="c"># if "topic " in topic])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span>  <span class="n">font_color</span><span class="o">=</span><span class="s">'black'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">([</span><span class="n">journal</span> <span class="k">for</span> <span class="n">journal</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pos</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">journal</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query_list</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">avg</span><span class="o">*</span><span class="mi">2</span> <span class="ow">or</span> 
               <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">avg</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c">## Algorithm for automatically detecting communities in the network</span>
<span class="n">part</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">part</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_list</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">'jet'</span><span class="p">),</span> <span class="n">node_color</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">degrees</span><span class="p">,</span> 
                       <span class="n">with_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">edges</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s">'weight'</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
   
    <span class="c"># plot edges</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edgelist</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">color_labels</span><span class="p">,</span> <span class="n">edge_labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">edge</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Co-occuring Journal Titles in Search Results for Top 6 Key Terms in Liu's 'Transcendental Data'"</span><span class="p">,</span>
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'search_network.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s">'landscape'</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s">'tight'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>/Users/collin/anaconda/lib/python3.4/site-packages/matplotlib/collections.py:650: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if self._edgecolors_original != str('face'):
/Users/collin/anaconda/lib/python3.4/site-packages/matplotlib/collections.py:590: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if self._edgecolors == str('face'):
</code></pre>
</div>

<p><img src="/assets/output_26_1.png" alt="terms" /></p>


</article>











      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      
    </small>
  </div>
</footer>


</body>
</html>
